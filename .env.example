APP_ENV=dev
API_PORT=8080

# Postgres tenant catalog
TENANT_CATALOG_DSN=postgresql+psycopg://postgres:postgres@localhost:5432/saas_platform
POSTGRES_POOL_SIZE=3
POSTGRES_MAX_OVERFLOW=0
POSTGRES_POOL_TIMEOUT_SECONDS=10
POSTGRES_POOL_RECYCLE_SECONDS=900

# Queue backend (storage_queue | service_bus)
PROVISIONING_QUEUE_BACKEND=storage_queue
PROVISIONING_WORKER_POLL_SECONDS=2
PROVISIONING_JOB_MAX_ATTEMPTS=3
PROVISIONING_RETRY_BASE_SECONDS=5

# Storage Queue transport (MI-first when PROVISIONING_QUEUE_BACKEND=storage_queue)
AZURE_STORAGE_QUEUE_ACCOUNT_URL=https://<storage-account>.queue.core.windows.net
AZURE_STORAGE_QUEUE_CONNECTION_STRING=
AZURE_STORAGE_QUEUE_NAME=provisioning-jobs
AZURE_STORAGE_QUEUE_DEAD_LETTER_QUEUE_NAME=provisioning-jobs-deadletter

# Service Bus transport (MI-first when PROVISIONING_QUEUE_BACKEND=service_bus)
AZURE_SERVICE_BUS_FULLY_QUALIFIED_NAMESPACE=<namespace>.servicebus.windows.net
AZURE_SERVICE_BUS_CONNECTION_STRING=
AZURE_SERVICE_BUS_QUEUE_NAME=provisioning-jobs
AZURE_SERVICE_BUS_DEAD_LETTER_QUEUE_NAME=provisioning-jobs-deadletter

# Foundry
AZURE_AI_PROJECT_ENDPOINT=

# Identity policy (MI-first)
AZURE_USE_MANAGED_IDENTITY=true
AZURE_MANAGED_IDENTITY_CLIENT_ID=
ALLOW_API_KEY_FALLBACK=false
AZURE_AI_PROJECT_API_KEY=

# Key Vault
KEY_VAULT_URL=

# Tenant auth for API and admin JWT validation
TENANT_API_KEYS_JSON={"tenant-dev":"dev-key-123"}

# Entra/OIDC JWT validation (recommended)
JWT_JWKS_URL=https://login.microsoftonline.com/<tenant-id>/discovery/v2.0/keys
JWT_ISSUER=https://login.microsoftonline.com/<tenant-id>/v2.0
JWT_AUDIENCE=api://<app-id-uri-or-client-id>
JWT_JWKS_CACHE_TTL_SECONDS=300

# Shared-secret fallback JWT validation (non-production fallback)
JWT_SHARED_SECRET=replace-with-32-char-min-secret
JWT_ALGORITHM=RS256

# Rate limiting backend (memory | redis)
RATE_LIMIT_BACKEND=memory
RATE_LIMIT_REDIS_URL=
RATE_LIMIT_REDIS_KEY_PREFIX=saas:ratelimit
RATE_LIMIT_REDIS_FAIL_OPEN=true

DEFAULT_RATE_LIMIT_RPM=60
